# 拟合插值（一）

## 插值：

插值是什么呢？很简单，插值就是找到一个比较简单的函数![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29)，满足![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x_i%29%3Dy_i%2Ci%3D0%2C1%2C2%2C...%2Cn)，之后使用![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29)这个函数来求得![[公式]](https://www.zhihu.com/equation?tex=x_0%2Cx_1%2Cx_2%2C...x_n)之间某个位置![[公式]](https://www.zhihu.com/equation?tex=x)的函数值。也就是找一个函数来代替![[公式]](https://www.zhihu.com/equation?tex=f%28x%29)，作为![[公式]](https://www.zhihu.com/equation?tex=f%28x%29)的一个合理近似

### 分段线性插值、三次Hermite插值、三次样条插值（具体情况具体分析）、拉格朗日插值、牛顿插值、最邻近插值：



三种插值方法有一个共同的特点，即它们是在给定点的每一个小段都确定一个函数表达式，叠加起来作为最终的表达式。嗯，也就是说这是一个分段函数，在![[公式]](https://www.zhihu.com/equation?tex=%5Bx_0%2Cx_1%5D)之间求一个函数，在![[公式]](https://www.zhihu.com/equation?tex=%5Bx_1%2Cx_2%5D)求一个函数，依次类推……

为什么不求出一个单一的函数表达式呢？因为当插值点越多，我们不进行分段时，最终得出来的函数的次数越高，而高次多项式会在插值的区间内发生严重的震荡现象，称之为“龙格现象”。



因此我们往往更倾向于使用分段低次多项式来近似原函数。拉格朗日插值以及牛顿插值，最终都是求出一个函数，因此这里不予介绍，有兴趣可以自行了解。

![](https://ccd123.oss-cn-guangzhou.aliyuncs.com/img/20220713225015.png)

龙格现象震荡图，n代表次数



## 分段线性插值：

分段线性插值不必多说了，很简单，就是在相邻的区间内，用直线来近似原函数。用分段线性插值计算![[公式]](https://www.zhihu.com/equation?tex=x)点的近似函数值时，只用到![[公式]](https://www.zhihu.com/equation?tex=x)左右的两个节点，与其他节点无关。当然啦，![[公式]](https://www.zhihu.com/equation?tex=n)越大，分段越多，插值的误差也就越小。实际使用中往往用来计算数学、物理中的特殊函数表，数理统计中的概率分布表等等。在建模过程中，也可以用来进行缺失数据的填补。

matlab中，插值使用到的函数是![[公式]](https://www.zhihu.com/equation?tex=interp1)函数，最后一个是数字![[公式]](https://www.zhihu.com/equation?tex=1)不是字母![[公式]](https://www.zhihu.com/equation?tex=l)。![[公式]](https://www.zhihu.com/equation?tex=1)代表着一维数据。



## 分段三次Hermite（埃尔米特）插值

分段三次埃尔米特插值比分段线性插值对数据的要求更高一点儿。假设![[公式]](https://www.zhihu.com/equation?tex=x_0%2Cx_1%2C...%2Cx_n)是[a,b]之间的互异节点，且![[公式]](https://www.zhihu.com/equation?tex=y_k%3Df%28x_k%29%2Cm_k%3Df%27%28x_k%29)。嗯，也就是我们不仅要知道![[公式]](https://www.zhihu.com/equation?tex=x_k)处对应的函数值![[公式]](https://www.zhihu.com/equation?tex=f%28x_k%29)，我们也需要知道![[公式]](https://www.zhihu.com/equation?tex=x_k)处对应的函数导数值![[公式]](https://www.zhihu.com/equation?tex=f%27%28x_k%29)。

因此我们对相应的插值函数![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29)有以下三个要求：

1. ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29)在![[公式]](https://www.zhihu.com/equation?tex=%5Ba%2Cb%5D)上一阶可导；
2. ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x_k%29%3Dy_k%2C%5Cpsi%27%28x_k%29%3Dm_k%2Ck%3D0%2C1%2C2%2C..%2Cn)；
3. ![[公式]](https://www.zhihu.com/equation?tex=%5Cpsi%28x%29)在每个![[公式]](https://www.zhihu.com/equation?tex=%5Bx_k%2Cx_%7Bk%2B1%7D%5D%2Ck%3D0%2C1%2C2%2C..%2Cn-1)上都是三次函数

matlab之中用于三次埃尔米特插值的函数是![[公式]](https://www.zhihu.com/equation?tex=p+%3D+pchip%28x%2Cy%2C+new_x%29)，当然也可以使用上面提到的![[公式]](https://www.zhihu.com/equation?tex=interp1)加上![[公式]](https://www.zhihu.com/equation?tex=pchip)参数。



## 三次样条插值

所谓样条曲线，就是把一根具有弹性的细长木条（样条）在几个样点处用压铁压住，其余位置自由弯曲。这样子，由样条形成的曲线就称之为样条曲线。样条曲线实际上是由分段三次曲线连接而成，且在连接点处具有连续的二阶导数，从数学上加以概括就得到三次样条的概念。



三次样条函数相对于三次埃尔米特插值，又增加了一些条件。假设三次样条函数![[公式]](https://www.zhihu.com/equation?tex=S%28x%29%3D%5Cbegin%7Bcases%7DS_0%28x%29%2Cx%5Cin%5Bx_0%2Cx_1%5D%5C%5CS_1%28x%29%2Cx%5Cin+%5Bx_1%2Cx_2%5D%5C%5C...%5C%5CS_%7Bn-1%7D%28x%29%2Cx%5Cin%5Bx_%7Bn-1%7D%2Cx_n%5D%5Cend%7Bcases%7D)。那它除了满足![[公式]](https://www.zhihu.com/equation?tex=S%28x_i%29%3Dy_i)，也就是经过已知点之外，还需要满足![[公式]](https://www.zhihu.com/equation?tex=S_%7Bk-1%7D%28x_i%29%3DS_k%28x_i%29)，也就是每一段的端点重合。

除此之外，还需要满足![[公式]](https://www.zhihu.com/equation?tex=S%27_%7Bk-1%7D%28x_i%29%3DS%27_k%28x_i%29)，也就是在端点处一阶光滑。以及![[公式]](https://www.zhihu.com/equation?tex=S%27%27_%7Bk-1%7D%28x_i%29%3DS%27%27_k%28x_i%29)，也就是端点处二阶光滑。我们可以看出，相对于埃尔米特插值，不仅有一阶导数的要求，也有二阶导数的要求。因此相对于埃尔米特插值，样条插值得到的曲线更加光滑。

以上这些等式条件，提供了![[公式]](https://www.zhihu.com/equation?tex=4n-2)个方程（可以自己数数），但如果我们需要![[公式]](https://www.zhihu.com/equation?tex=n)个三次多项式，就需要解出![[公式]](https://www.zhihu.com/equation?tex=4n)个未知数，也就是需要![[公式]](https://www.zhihu.com/equation?tex=4n)个方程。剩下的两个方程，我们称之为边界条件。

边界条件主要有三类：

1. 第一类边界条件：给定函数在端点处的一阶导数，即![[公式]](https://www.zhihu.com/equation?tex=S%27%28x_0%29%3Dm_0%2CS%27%28x_n%29%3Dm_n)。
2. 第二类边界条件：给定函数在端点处的二阶导数，即![[公式]](https://www.zhihu.com/equation?tex=S%27%27%28x_0%29%3DM_0%2CS%27%27%28x_n%29%3DM_n)。当![[公式]](https://www.zhihu.com/equation?tex=M_0%3DM_n)时，该条件称之为自然边界条件。
3. 第三类边界条件：若![[公式]](https://www.zhihu.com/equation?tex=f%28x%29)是一个周期函数，且![[公式]](https://www.zhihu.com/equation?tex=x_n-x_0)是一个周期，则要求![[公式]](https://www.zhihu.com/equation?tex=S%28x%29)也是一个周期函数，满足![[公式]](https://www.zhihu.com/equation?tex=S%28x_0%29%3DS%28x_n%29%2CS%27%28x_0%29%3DS%27%28x_n%29%2CS%27%27%28x_0%29%3DS%27%27%28x_n%29)。

在matlab中，如果三次样条插值没有边界条件，最常用的方法就是采用非结终止条件进行插值。该条件要求第一个和第二个三次多项式的三阶导数相同，以及倒数第一个和倒数第二个三次多项式的三阶导数值相同。使用的函数可以是![[公式]](https://www.zhihu.com/equation?tex=p+%3D+spline+%28x%2Cy%2C+new_x%29+)，也可以是![[公式]](https://www.zhihu.com/equation?tex=p%3Dinterp1%28x%2Cy%2Cnew_x%2C%27spline%27%29)。同样的，至少要求四个点已知。

